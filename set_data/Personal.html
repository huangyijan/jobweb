<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Personal</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
    <meta name="keywords" content="招聘网"/>
    <meta name="description" content="招聘网"/>
    <link rel="stylesheet" href="base.css" type="text/css"/>
    <link rel="stylesheet" href="common-less(1).css" type="text/css"/>
    <link rel="stylesheet" href="moco.min.css" type="text/css"/>
    <link rel="stylesheet" href="common-less.css" type="text/css"/>
    <link rel="stylesheet" href="profile-less.css" type="text/css"/>
    <link rel="stylesheet" href="../components/global.css">
</head>

<body>
<div id="main">
    <header_nav></header_nav>

    <div class="page-settings" style="margin-top: 50px">
        <div class="top">
            <div class="w960 mauto top_title">
                <p>个人资料设置</p>
            </div>
        </div>
        <div class="setting pb10" style="height: 1000px">
            <div class="nav-tabs pa">
                <h class="baseinfo fl active">基本信息</h>
                <div class="cb"></div>
            </div>
            <div class="contentBox">
                <div class="formBox">
                    <div id="setting-profile" class="setting-wrap setting-profile">

                        <div class="wlfg-wrap clearfix ">
                            <label class="label-name" for="job">头像：</label>
                            <div class="rlf-group">
                                <img class="fl avator-img" id="js-portrait"
                                     :src="form.imgUrl"
                                     data-portrait="58492fe600012e8e01800180" width="180" height="180">
                                <div class="fl ml20 pr">
                                    <div id="avator-btns" class="avator-btn-inner">


                                        <div class="avator-btn-wrap">
                                            <form target="uploadtarget" action="postpic" method="post"
                                                  enctype="multipart/form-data" style="position: relative;top: 100px">
                                                <a href="javascript:void(0)" hidefocus="true" class="avator-btn-fake"
                                                   style="margin-bottom: -30px">上传头像</a>
                                                <input class="hide" type="file"
                                                       style="display: block;position: absolute;height: 50px;opacity: 0"
                                                       title="上传头像" @change="UploadImage($event)" name="fileField"
                                                       id="upload" accept="image/*">
                                                <input class="hide" type="hidden" name="type" value="1">
                                            </form>
                                            <iframe src="about:blank" id="uploadtarget" name="uploadtarget"
                                                    frameborder="0" style="display:none;"></iframe>
                                        </div>
                                    </div>
                                </div>
                                <div class="cb"></div>
                                <p class="rlf-tip-wrap errorHint color-red"></p>
                            </div>
                        </div>

                        <form id="profile">

                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="nick">昵称：</label>
                                <div class="rlf-group">
                                    <input type="text" name="nickname" id="nick" autocomplete="off"
                                           data-validate="require-nick" class="moco-form-control" v-model="form.name"
                                           placeholder="请输入昵称."/>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>

                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="nick">邮箱：</label>
                                <div class="rlf-group">
                                    <input type="text" name="nickname" id="email" autocomplete="off"
                                           data-validate="require-nick" class="moco-form-control" v-model="form.email"
                                           placeholder="请输入邮箱."/>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>
                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="job">职位：</label>
                                <div class="rlf-group">
                                    <select class="moco-form-control rlf-select" name="job" hidefocus="true" id="job"
                                            data-validate="require-select" v-model="form.profession">
                                        <option>请选择职位</option>
                                        <option>学生</option>
                                        <option>页面重构设计</option>
                                        <option>Web前端工程师</option>
                                        <option>JS工程师</option>
                                        <option>PHP开发工程师</option>
                                        <option>JAVA开发工程师</option>
                                        <option>移动开发工程师</option>
                                        <option>软件测试工程师</option>
                                        <option>Linux系统工程师</option>
                                        <option>交互设计师</option>
                                        <option>产品经理</option>
                                        <option>数据库工程师</option>
                                        <option>UI设计师</option>
                                        <option>CG影视动画师</option>
                                        <option>全栈工程师</option>
                                    </select>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>
                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="nick">地址：</label>
                                <div class="rlf-group">
                                    <input type="text" name="nickname" id="adddress" autocomplete="off"
                                           data-validate="require-nick" class="moco-form-control" v-model="form.address"
                                           placeholder="请输入地址."/>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>
                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="nick">电话：</label>
                                <div class="rlf-group">
                                    <input type="text" name="nickname" id="phone" autocomplete="off"
                                           data-validate="require-nick" class="moco-form-control" v-model="form.phone"
                                           placeholder="请输入联系方式."/>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>
                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="nick">个性签名：</label>
                                <div class="rlf-group">
                                    <input type="text" name="nickname" id="sign" autocomplete="off"
                                           data-validate="require-nick" class="moco-form-control" v-model="form.sign"
                                           placeholder="请输入个人签名."/>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>
                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="nick">出生日期：</label>
                                <div class="rlf-group">
                                    <input type="text" name="nickname" id="date" autocomplete="off"
                                           data-validate="require-nick" class="moco-form-control" v-model="form.date"
                                           placeholder="请输入你的生日."/>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>

                            <div class="wlfg-wrap clearfix">
                                <label class="label-name h16 lh16">性别：</label>
                                <div class="rlf-group rlf-radio-group">
                                    <label class="lh16"><input type="radio" hidefocus="true" value="保密"
                                                               name="sex" v-model="form.sex">保密</label>
                                    <label class="lh16"><input type="radio" hidefocus="true" value="男"
                                                               name="sex" v-model="form.sex">男</label>
                                    <label class="lh16"><input type="radio" hidefocus="true" value="女" checked="checked"
                                                               name="sex" v-model="form.sex">女</label>
                                    <p class="rlf-tip-wrap errorHint color-red"></p>
                                </div>
                            </div>
                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="aboutme">个人描述：</label>
                                <div class="rlf-group">
                                    <div class="pr">
                                        <textarea name="aboutme" id="aboutme" rows="5"
                                                  class="noresize js-sign moco-form-control"
                                                  v-model="form.desc"></textarea>
                                        <p class="numCanInput js-numCanInput ">还可以输入128个字符</p>
                                    </div>
                                </div>
                            </div>

                            <div class="wlfg-wrap clearfix">
                                <label class="label-name" for="profile-submit"></label>
                                <div class="rlf-group">
                                    <span id="profile-submit" hidefocus="true" aria-role="button"
                                          class="rlf-btn-green btn-block profile-btn" @click="saveData()">保存</span>
                                </div>
                            </div>
                        </form>

                    </div>
                </div>
            </div>
        </div>

    </div>

</div>


<script src="../vue.min.js"></script>
<script src="../jquery-3.3.1.min.js"></script>
<script src="../components/header.js"></script>
<script>
    var app = new Vue({
        el: "#main",
        data: {
            form: window.sessionStorage.getItem('personInfo') ? JSON.parse(window.sessionStorage.getItem('personInfo')) : {
                imgUrl: '',
                name: '',
                profession: '',
                address: '',
                sex: '',
                sign: '',
                email: '',
                phone: '',
                date: '',
                desc: '',
            }
        },
        methods: {
            UploadImage(e) {
                /*
                      * @author huangyijian(1172256619@qq.com)
                      * @date 2018/9/13 16:41
                      * @for 图片即使加载
                      * @version 1.0
                      */
                // 触发事件获得的事件里面得到上传的文件，可以点开console里面直接找
                const files = e.target.files || e.dataTransfer.files
                // 图片为空判断
                if (!files.length) {
                    return
                }
                // 创建读文件的容器
                const reader = new FileReader()
                // 取到文件后回调
                reader.onload = (e) => {
                    /*
                       * @author huangyijian(1172256619@qq.com)
                       * @date 2018/8/16 11:46
                       * @for 填充容器，实现预加载
                       * @version 1.0
                       */
                    this.form.imgUrl = e.target.result
                    console.log(this.form.imgUrl)
                }
                reader.readAsDataURL(files[0])
                // this.$global.fileList(this, files[0], '/comm/imageUpload', (value) => {
                //     this.template_container.url = value.data
                // })
            },
            saveData() {
                console.log(this.form)
                let that = this
                $.ajax({
                    url: 'https://hyjweb.cn/api/update',
                    type: 'get',
                    data: this.form,
                    success: function (data) {
                        console.log(data)
                        window.sessionStorage.setItem('personInfo', JSON.stringify(that.form))
                        window.location.href = "../../job/person/file.html"
                    }
                })
            }
        }
    })
</script>
</body>
</html>
